\documentclass[main.tex]{subfiles}
\usepackage{tikz}
\usetikzlibrary{arrows.meta, positioning}
\usepackage{graphicx}

\begin{document}
\begin{frame}[fragile]
    \frametitle{Exponential distribution}
    \begin{itemize}
        \item<+-> This exercise is an illustration of the method of moments.
        \item<+-> Using PowerBI and R, generate a population from an exponential distribution with rate 2:
{\footnotesize
\begin{verbatim}
sim_exp <- data.frame(n=1:100000,x=rexp(100000,rate=2))
\end{verbatim}}
        \item<+-> Compute the mean $m$ and the standard deviation $\sigma$ (square root of the variance) on $1000$ samples of size $1000$.
        \item<+-> Estimate the number of times $\lvert m - 0.5 \rvert$ (resp. $\lvert \sigma - 0.5 \rvert$) is greater than $0.026.$
        \item<+-> In your opinion, which estimator of the inverse of the rate is the best one ?
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Confidence intervals}
    \begin{itemize}
        \item<+-> A consistent estimator $\hat{\theta}$ will fall within a given interval around the true value $\theta$ with a probability close to 1
        if the sample size is large enough.
        \item<+-> In practice, the sample size is fixed, so that one wants to find $c$ such that:
        \begin{equation}
            P\left[ \lvert \hat{\theta} - \theta \rvert > c \right] = \alpha,
        \end{equation}
        where $\alpha \in [0,1]$ is a fixed value.
        \item<+-> The interval:
        \[
        \left[ \hat{\theta}-c, \hat{\theta} + c \right]
        \]
        contains $\theta$ with probability $1- \alpha.$
        \item<+-> $1-\alpha$ is called the confidence level.
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Confidence intervals}
    \begin{itemize}
        \item<+-> Generally speaking, a confidence interval for $\theta$ at level $1-\alpha$ is a pair of estimators $\hat{\theta}_1, \hat{\theta}_2$ 
        such that:
        \[
        P\left[\theta \in  \left[ \hat{\theta}_1, \hat{\theta}_2\right] \right] = 1-\alpha.
        \]
        \item<+-> A classical situation encountered is when $\hat{\theta}$ is the sample mean:
        \[
        \hat{\theta} = \bar{X} = \frac{1}{n} \sum_{i=1}^n X_i.
        \]
    \end{itemize}
\end{frame}

\begin{frame}
    \frametitle{Using the TCL}
\begin{itemize}
    \item<+-> When the sample mean is an unbiased estimator of $\theta$, then, in the limit of large samples:
    \begin{equation}
        Z = \frac{\sqrt{n}\left( \bar{X} - \theta \right)}{\sigma}
    \end{equation}
    is $\mathcal{N}(0,1)$-distributed.
    \item<+-> For a given confidence level $1-\alpha$, one can find $c$ such that:
    \begin{equation}
        P\left[ \lvert Z \rvert \leq c \right] = 1-\alpha.
    \end{equation}
    \item<+-> A confidence interval for $\theta$ is then:
    \begin{equation}
        \left[ \bar{X} - \frac{\sigma c}{\sqrt{n}}, \bar{X} + \frac{\sigma c}{\sqrt{n}}\right]
    \end{equation}
    \item<+-> The approximation is correct provided $n \geq 30.$
\end{itemize}
\end{frame}
\begin{frame}
    \frametitle{Exponential distribution}
\begin{block}{Estimating the expected value}
    \begin{itemize}
        \item<+-> Going back to the example of the exponential distribution, and assuming one wants to 
        estimate the inverse of the rate $\lambda^{-1}$, the sample mean is an unbiased estimator.
        \item<+-> Using the TCL, can you find a confidence interval for $\lambda^{-1}$ at confidence level $0.90$ ?
        \item<+-> Is the threshold $0.026$ used before coherent with what you found ?
    \end{itemize}
\end{block}
\end{frame}
\begin{frame}
    \frametitle{The delta method}
\begin{itemize}
    \item<+-> Sometimes, the estimator is a function $g$ of the sample mean and the TCL cannot be applied directly.
    \item<+-> However, if $g$ is continuously differentiable and the TCL gives:
    \begin{equation}
        \sqrt{n}\left( \bar{X}  -  \theta \right) \to \mathcal{N}(0,\sigma^2),
    \end{equation}
    then:
    \begin{equation}
        \sqrt{n}\left[ g\left( \bar{X} \right) - g(\theta) \right] \to \mathcal{N}\left( 0, \left(g^\prime(\theta)\right)^2 \sigma^2 \right)
    \end{equation}
    \item<+-> $\theta$ can be replaced by $\bar{X}$ in the right hand side.
\end{itemize}
\end{frame}
\begin{frame}
    \frametitle{The delta method}
\begin{itemize}
    \item<+-> Use the delta method to find a confidence interval at confidence level $0.9$ for the rate in the exponential distribution example.
    \item<+-> Compare it with the one obtained by applying the inverse on the bounds of the confidence interval for $\lambda^{-1}.$
\end{itemize}
\end{frame}
\begin{frame}
    \frametitle{Slutsky's theorem}
    \begin{itemize}
    \item<+-> Let $Y_n$ be a family of random variables converging to a constant $c$ in the sense that, for any $\epsilon > 0$:
    \[
    P\left[ \lvert Y_n -c \rvert > \epsilon \right] \to 0,
    \]
    \item<+-> Let $X_1, \dots , X_n$ be an iid sample of a population distribution with expected value $\mu$ and variance $\sigma^2$.
    \item<+-> Then:
    \begin{equation}
        \sqrt{n}\left( Y_n \bar{X} - c \mu \right) \to \mathcal{N}\left( 0, c^2 \sigma^2 \right).
    \end{equation}
    \item<+-> This theorem justifies the use of the sample variance instead of the true one in the TCL.
\end{itemize}
\end{frame}
\begin{frame}
    \frametitle{Normally distributed samples}
    \begin{block}{Estimating the mean}
\begin{itemize}
    \item<+-> In the case of normally distributed samples, it is possible to derive confidence intervals even 
    for small samples.
    \item<+-> For a sample of size $n$, if $S$ is the sample standard deviation, then the confidence interval for the mean at 
    level $1-\alpha$ is:
    \begin{equation}
        \left[ \bar{X} - c \frac{S}{\sqrt{n}}, \bar{X} + c \frac{S}{\sqrt{n}} \right]
    \end{equation}
    where $c$ is the value such that:
    \begin{equation}
        P\left[ \lvert T \rvert > c \right] = \alpha,
    \end{equation}
    $T$ being distributed according to a \textbf{Student's distribution} with $n-1$ degrees of freedom.
\end{itemize}
    \end{block}
\end{frame}
\begin{frame}
    \frametitle{Normally distributed samples}
    \begin{block}{Estimating the variance}
\begin{itemize}
    \item<+-> Using the same notations, a confidence interval at level $1-\alpha$ for the variance is:
    \begin{equation}
        \left[ \frac{(n-1)S^2}{c_2}, \frac{(n-1)S^2}{c_1} \right]
    \end{equation}
    where $c_1,c_2$ are such that:
    \begin{equation}
        P\left[ \lvert Z \rvert > c_2 \right] = P\left[ \lvert Z \rvert < c_1 \right] = \frac{\alpha}{2}
    \end{equation}
    $X$ being distributed according to a \textbf{Chi square distribution} with $n-1$ degrees of freedom.
\end{itemize}
    \end{block}
\end{frame}
\end{document}
